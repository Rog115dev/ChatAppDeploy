import{_ as t,q as e,s,G as a,a4 as i,C as o,r as n,c as r,w as h,g as c,o as l,a as d,e as m,t as g,m as p,i as u,W as f}from"./index-37Su0qRO.js";import{_ as x}from"./mosowe-canvas-image.DRWs3IMG.js";import{r as y}from"./uni-app.es.D58nOoD0.js";const v=e(s);const w=t({data:()=>({canvasUrl:"",group_id:0,lists:[],width:500,height:700,title:"我的二维码",contact:{}}),components:{mosoweCanvasImage:x},onLoad(t){this.group_id=t.group_id?t.group_id:"",this.group_id?(this.title="群二维码",this.getGroupInfo()):this.createUserQr()},methods:{createUserQr(){let t=v.userInfo,e=t.qrUrl??"";if(!e)return a({title:"请重新登陆后再生成二维码",icon:"none"}),void i();this.lists=[{type:"rect",color:"#ffffff",width:this.width,height:this.height,x:0,y:0},{type:"image",content:t.avatar,width:100,height:100,x:70,y:60},{type:"text",content:t.displayName,x:190,y:96,maxWidth:400,color:"#000",size:28},{type:"text",content:t.mask,x:190,y:135,maxWidth:400,color:"#999",size:20},{type:"qr",content:e,width:360,height:360,x:70,y:200},{type:"text",content:"扫一扫上面的二维码图案，加我为好友",x:105,y:620,color:"#999",maxWidth:400,size:18}],setTimeout((()=>{this.$refs.mosoweCanvasComponents.createCanvas()}),100)},getGroupInfo(){this.userList=[],this.$api.msgApi.groupInfo({group_id:this.group_id}).then((t=>{let e=t.data;this.contact=e;let s=e.name;s.length>12&&(s=s.substring(0,12)+"..."),this.lists=[{type:"rect",color:"#ffffff",width:this.width,height:this.height,x:0,y:0},{type:"image",content:e.avatar,width:100,height:100,x:200,y:40},{type:"text",content:"群聊："+s,x:this.width/2,align:"center",y:180,maxWidth:400,color:"#000",size:24},{type:"qr",content:e.qrUrl,width:360,height:360,x:70,y:220},{type:"text",content:"该二维码7天内（"+e.qrExpire+"前）有效",x:105,y:640,color:"#999",maxWidth:400,size:18}],setTimeout((()=>{this.$refs.mosoweCanvasComponents.createCanvas()}),100)}))},canvasImage(t){this.canvasUrl=t},saveHeadImgFile(){const t=document.createElement("a");t.style.display="none",t.href=this.canvasUrl,t.setAttribute("download",this.contact.name+".jpg"),t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}}},[["render",function(t,e,s,a,i,v){const w=o("cu-custom"),C=u,_=c,I=f,b=y(n("mosowe-canvas-image"),x);return l(),r(_,null,{default:h((()=>[d(w,{bgColor:"bg-video",isBack:!0},{backText:h((()=>[])),content:h((()=>[m(g(i.title),1)])),_:1}),d(_,{class:"mt-20 im-flex im-align-items-center"},{default:h((()=>[d(C,{src:i.canvasUrl,mode:"widthFix",style:{margin:"0 auto"}},null,8,["src"])])),_:1}),i.canvasUrl?(l(),r(_,{key:0,class:"padding flex flex-direction mt-10"},{default:h((()=>[d(I,{class:"cu-btn bg-green lg",onClick:v.saveHeadImgFile},{default:h((()=>[m(" 下载图片 ")])),_:1},8,["onClick"])])),_:1})):p("",!0),d(b,{ref:"mosoweCanvasComponents",lists:i.lists,height:i.height,width:i.width,onCanvasImage:v.canvasImage},null,8,["lists","height","width","onCanvasImage"])])),_:1})}],["__scopeId","data-v-e8dca8e6"]]);export{w as default};
