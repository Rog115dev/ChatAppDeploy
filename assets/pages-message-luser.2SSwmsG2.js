import{_ as t,u as e,s as a,q as s,p as l,ao as i,n,C as o,c as r,w as d,g as c,o as u,f as m,a as h,b as p,d as f,F as g,e as y,t as b,m as C,U as x,K as _,L as k,j as w,ab as T,X as v,l as L,ac as I,i as S}from"./index-CDOpH1f_.js";import{b as B}from"./breadcrum.Cqxo9PB4.js";import{s as D}from"./status.BmvdSoJv.js";const j=e(a),V=s(a),{contacts:N,sysUnread:O}=l(j);const M=t({components:{breadcurm:B,statusPoint:D},name:"contacts",props:{TabCur:{type:Number,default:0}},data:()=>({tabbarH:50,hidden:!0,listCurID:"",list:[],systemContact:[],listCur:"",total:0,scrollLeft:0,msgs:N,unread:O,globalConfig:V.globalConfig,appSetting:V.appSetting,tree:[{id:1,name:"技术部"},{id:2,name:"产品部"},{id:3,name:"信息部"}],depList:[{id:1,name:"技术部"},{id:2,name:"财务部"}],userList:[{id:1,realname:"张三",avatar:"https://api.multiavatar.com/raingad1.png?apikey=zdvXV3W4MjwhP9"},{id:2,realname:"李四",avatar:"https://api.multiavatar.com/raingad2.png?apikey=zdvXV3W4MjwhP9"}],tabList:["普通通讯录","企业通讯录"],contacts:[],keywords:"",label_id:0}),watch:{msgs(t){this.initContacts(t)}},created(){this.listCur=this.contacts[0]},mounted(){this.initContacts(this.msgs)},onLoad(t){i({title:`${t.name}(${t.count})`}),this.label_id=t.id},methods:{initContacts(t){const e=JSON.parse(JSON.stringify(t)),a=e.filter((t=>0==t.is_group&&t.tags&&t.tags.includes(parseInt(this.label_id))));this.systemContact=e.filter((t=>2==t.is_group)),this.total=a.length;const s=a.sort(((t,e)=>"#"===t.index?1:"#"===e.index?-1:t.index.localeCompare(e.index,"zh"))).reduce(((t,e)=>{const a=e.index,s=t.findIndex((t=>t.name===a));return-1===s?t.push({name:a,children:[e]}):t[s].children.push(e),t}),[]);this.contacts=s},openDep(t){},openChat(t){n({url:"/pages/message/chat?id="+t,animationType:"slide-in-right"})},openDetails(t){n({url:"/pages/contacts/detail?id="+t.id})},openGroup(){n({url:"/pages/contacts/group"})},openLabel(){n({url:"/pages/message/label"})},openFriend(){n({url:"/pages/contacts/friend"})},tabSelect(t){this.TabCur=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.id-1)},getCur(t){this.hidden=!1,this.listCur=this.contacts[t.target.id].name},setCur(t){this.hidden=!0,this.listCur=this.listCur},tMove(t){let e=t.touches[0].clientY,a=this.boxTop,s=this;if(e>a){let t=parseInt((e-a)/20);this.listCur=s.contacts[t].name}},tStart(){this.hidden=!1},tEnd(){this.hidden=!0,this.listCurID=this.listCur},indexSelect(t){let e=this,a=this.barHeight,s=this.contacts,l=Math.ceil(s.length*t.detail.y/a);for(let i=0;i<s.length;i++)if(l<i+1)return e.listCur=s[i].name,e.movableY=20*i,!1}}},[["render",function(t,e,a,s,l,i){const n=w,B=T,D=c,j=o("Empty"),V=v,N=o("breadcurm"),O=I,M=S;return u(),r(D,null,{default:d((()=>[0==a.TabCur?(u(),r(V,{key:0,"scroll-y":"",class:"indexes","scroll-into-view":"indexes-"+l.listCurID,style:m([{height:"calc(100vh - "+(t.CustomBar+t.inlineTools+t.StatusBar)+"px)"}]),"scroll-with-animation":!0,"enable-back-to-top":!0},{default:d((()=>[h(D,{style:{"padding-bottom":"30rpx"}},{default:d((()=>[h(D,{class:"cu-bar search"},{default:d((()=>[h(D,{class:"search-form round"},{default:d((()=>[h(n,{class:"cuIcon-search"}),h(B,{type:"text",modelValue:l.keywords,"onUpdate:modelValue":e[0]||(e[0]=t=>l.keywords=t),placeholder:"搜索成员","confirm-type":"search"},null,8,["modelValue"])])),_:1})])),_:1}),(u(!0),p(g,null,f(l.contacts,((t,e)=>(u(),r(D,{key:e,class:L("indexItem-"+t.name),id:"indexes-"+t.name,"data-index":t.name},{default:d((()=>[h(D,{class:"padding"},{default:d((()=>[y(b(t.name),1)])),_:2},1024),h(D,{class:"cu-list menu no-padding"},{default:d((()=>[(u(!0),p(g,null,f(t.children,((t,e)=>(u(),r(D,{class:"cu-item",key:e,onClick:e=>i.openDetails(t)},{default:d((()=>[!l.keywords||t.displayName.toLowerCase().indexOf(l.keywords.toLowerCase())>=0?(u(),r(D,{key:0,class:L(["cu-avatar mr-15",l.appSetting.circleAvatar?"round":"radius"]),style:m([{backgroundImage:"url("+t.avatar+")"}])},{default:d((()=>[t.is_online&&0==t.is_group&&l.globalConfig.chatInfo&&1==l.globalConfig.chatInfo.online?(u(),r(D,{key:0,class:"online-status-small"})):C("",!0)])),_:2},1032,["class","style"])):C("",!0),!l.keywords||t.displayName.toLowerCase().indexOf(l.keywords.toLowerCase())>=0?(u(),r(D,{key:1,class:"content"},{default:d((()=>[h(D,{class:"c-f2cd77 disNameS"},{default:d((()=>[y(b(t.displayName),1)])),_:2},1024)])),_:2},1024)):C("",!0),h(D,{class:"deliver"})])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1032,["class","id","data-index"])))),128)),h(D,{class:"text-center m-20 text-grey"},{default:d((()=>[y(b(l.total)+" 个朋友",1)])),_:1}),l.contacts.length?C("",!0):(u(),r(j,{key:0,noDatatext:"暂无联系人",textcolor:"#999"}))])),_:1})])),_:1},8,["scroll-into-view","style"])):C("",!0),0==a.TabCur?(u(),r(D,{key:1,class:"indexBar",style:m([{height:"calc(100vh - "+t.CustomBar+"px - 50px)"}])},{default:d((()=>[h(D,{class:"indexBar-box",onTouchstart:i.tStart,onTouchend:i.tEnd,onTouchmove:x(i.tMove,["stop"])},{default:d((()=>[(u(!0),p(g,null,f(l.contacts,((t,e)=>(u(),r(D,{class:"indexBar-item",key:e,id:e,onTouchstart:i.getCur,onTouchend:i.setCur},{default:d((()=>[y(b(t.name),1)])),_:2},1032,["id","onTouchstart","onTouchend"])))),128))])),_:1},8,["onTouchstart","onTouchend","onTouchmove"])])),_:1},8,["style"])):C("",!0),1==a.TabCur?(u(),r(D,{key:2,class:"cu-bar bg-white search fixed",style:m([{top:t.CustomBar+"px"}])},{default:d((()=>[h(D,{class:"search-form round"},{default:d((()=>[h(n,{class:"cuIcon-search"}),h(B,{type:"text",modelValue:l.keywords,"onUpdate:modelValue":e[1]||(e[1]=t=>l.keywords=t),placeholder:"输入搜索的关键词","confirm-type":"search"},null,8,["modelValue"])])),_:1})])),_:1},8,["style"])):C("",!0),1==a.TabCur?(u(),r(V,{key:3,"scroll-y":"",class:"indexes",style:m([{top:"50px",height:"calc(100vh - "+(t.CustomBar+t.inlineTools+t.StatusBar)+"px)"}]),"scroll-with-animation":!0,"enable-back-to-top":!0},{default:d((()=>[h(D,{class:""},{default:d((()=>[h(N,{tree:l.tree,onOpenBread:i.openDep},null,8,["tree","onOpenBread"])])),_:1}),h(D,{class:"im-department-list"},{default:d((()=>[(u(!0),p(g,null,f(l.depList,((t,e)=>(u(),r(O,{class:"im-flex im-justify-content-start im-align-items-center mt-10",onClick:e=>i.openDep(t),key:e},{default:d((()=>[h(D,{class:"im-folder-bar mr-10"},{default:d((()=>[h(n,{class:"cuIcon-file color-blue"})])),_:1}),h(D,{class:"im-list-body im-border-b"},{default:d((()=>[h(D,{class:"im-list-title word"},{default:d((()=>[y(b(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),(u(!0),p(g,null,f(l.userList,((t,e)=>(u(),r(O,{class:"im-flex im-justify-content-start im-align-items-center mt-10",key:t.id,url:"/pages/contacts/detail?user_id="+t.id},{default:d((()=>[h(D,{class:"im-folder-bar im-image mr-10"},{default:d((()=>[h(M,{src:t.avatar,mode:"widthFix"},null,8,["src"])])),_:2},1024),h(D,{class:"im-list-body im-border-b"},{default:d((()=>[h(D,{class:"im-list-title word"},{default:d((()=>[y(b(t.realname),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128)),0==l.depList.length&&0==l.userList.length?(u(),r(j,{key:0})):C("",!0)])),_:1})])),_:1},8,["style"])):C("",!0),_(h(D,{class:"indexToast"},{default:d((()=>[y(b(l.listCur),1)])),_:1},512),[[k,!l.hidden]])])),_:1})}],["__scopeId","data-v-1d62e3dc"]]);export{M as default};
