import{_ as s,q as a,s as e,M as o,a5 as t,x as l,G as i,a2 as n,A as c,B as u,n as d,C as m,r,b as p,a as g,w as f,f as h,F as _,g as b,o as C,e as k,l as y,d as I,c as x,ac as F,j as w,ab as q,i as D,W as $,t as j}from"./index-37Su0qRO.js";import{_ as A}from"./uni-icons.u6lZObLY.js";import{r as S}from"./uni-app.es.D58nOoD0.js";import{_ as v}from"./uni-popup-dialog.7LTAtyIK.js";import{_ as z}from"./uni-popup.DS8t7ts6.js";const B=a(e);const T=s({data:()=>({amount:"",inputFocus:!1,uploadedImage:"",img:"",quickAmounts:[100,200,500,1e3],globalConfig:B.globalConfig}),computed:{canSubmit(){return this.amount&&this.amount>0}},onShow(){B.getGlobalConfig(),this.globalConfig=B.globalConfig,this.$forceUpdate()},methods:{chooseImage(){o({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:s=>{t({url:this.$api.msgApi.uploadUrl,filePath:s.tempFiles[0].path,name:"file",header:{Authorization:l("authToken")},success:a=>{let e=JSON.parse(a.data);0==e.code?(this.img=e.data.src,this.uploadedImage=s.tempFiles[0].path):i({title:e.msg,icon:"none"})}})}})},deleteImage(){this.uploadedImage="",this.img=""},saveQRCode(){n({url:this.globalConfig.wx.code,success:s=>{200===s.statusCode&&i({title:"二维码已保存成功",icon:"success"})}})},showConfirmDialog(){this.canSubmit?this.$refs.confirmDialog.open():i({title:"请填写完整信息",icon:"none"})},closeDialog(){this.$refs.confirmDialog.close()},submitRecharge(){c({title:"提交中..."}),this.$api.msgApi.recharge({money:this.amount,img:this.img}).then((s=>{u(),i({title:s.msg,icon:"none"}),0==s.code&&(this.amount="",this.uploadedImage="",this.img="",d({url:"/pages/mine/rechargelist"}))}))}}},[["render",function(s,a,e,o,t,l){const i=F,n=m("cu-custom"),c=w,u=q,d=b,B=D,T=S(r("uni-icons"),A),R=$,U=S(r("uni-popup-dialog"),v),V=S(r("uni-popup"),z);return C(),p(_,null,[g(n,{bgColor:"bg-gradual-green",isBack:!0},{backText:f((()=>[])),content:f((()=>[k("充值")])),right:f((()=>[g(i,{style:{"padding-right":"10px"},url:"/pages/mine/rechargelist"},{default:f((()=>[k("充值记录")])),_:1})])),_:1}),g(d,{class:"container",style:h({height:`calc(${s.safeHeight}px - ${s.CustomBar}px)`})},{default:f((()=>[g(d,{class:"section"},{default:f((()=>[g(c,{class:"section-title"},{default:f((()=>[k("充值金额")])),_:1}),g(d,{class:"amount-input"},{default:f((()=>[g(c,{class:"currency"},{default:f((()=>[k("¥")])),_:1}),g(u,{type:"number",placeholder:"请输入充值金额",modelValue:t.amount,"onUpdate:modelValue":a[0]||(a[0]=s=>t.amount=s),onFocus:a[1]||(a[1]=s=>t.inputFocus=!0),onBlur:a[2]||(a[2]=s=>t.inputFocus=!1),class:y({"input-focus":t.inputFocus})},null,8,["modelValue","class"])])),_:1}),g(d,{class:"quick-amount"},{default:f((()=>[(C(!0),p(_,null,I(t.quickAmounts,(s=>(C(),x(c,{key:s,class:"amount-btn",onClick:a=>t.amount=s},{default:f((()=>[k("¥"+j(s),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),g(d,{class:"section qr-section"},{default:f((()=>[g(c,{class:"section-title"},{default:f((()=>[k("收款方式")])),_:1}),g(d,{class:"qr-container"},{default:f((()=>[g(B,{class:"qr-code",src:t.globalConfig.wx.code,mode:"aspectFit"},null,8,["src"]),g(c,{class:"notice"},{default:f((()=>[k("支付完成后上传凭证")])),_:1})])),_:1})])),_:1}),g(d,{class:"section"},{default:f((()=>[g(c,{class:"section-title"},{default:f((()=>[k("上传交易凭证")])),_:1}),t.uploadedImage?(C(),x(d,{key:1,class:"preview-area"},{default:f((()=>[g(B,{class:"preview-image",mode:"aspectFit",src:t.uploadedImage},null,8,["src"]),g(d,{class:"delete-btn",onClick:l.deleteImage},{default:f((()=>[g(T,{type:"close",size:"16",color:"#fff"})])),_:1},8,["onClick"])])),_:1})):(C(),x(d,{key:0,class:"upload-area",onClick:l.chooseImage},{default:f((()=>[g(T,{type:"plus",size:"24",color:"#999"}),g(c,{class:"upload-text"},{default:f((()=>[k("点击上传支付凭证")])),_:1})])),_:1},8,["onClick"]))])),_:1}),g(d,{class:"submit-section"},{default:f((()=>[g(R,{class:"submit-btn",disabled:!l.canSubmit,onClick:l.showConfirmDialog},{default:f((()=>[k("提交申请")])),_:1},8,["disabled","onClick"])])),_:1}),g(V,{ref:"confirmDialog",type:"dialog"},{default:f((()=>[g(U,{type:"info",title:"确认提交",content:"确认提交充值申请？",onConfirm:l.submitRecharge,onClose:l.closeDialog},null,8,["onConfirm","onClose"])])),_:1},512)])),_:1},8,["style"])],64)}],["__scopeId","data-v-82a8a96a"]]);export{T as default};
