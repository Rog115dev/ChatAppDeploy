import{_ as a,G as t,A as s,B as e,M as l,a5 as u,x as i,C as o,r as c,b as r,a as h,w as d,f as n,F as f,g as m,o as p,e as k,t as _,c as b,m as g,j as y,ab as w,i as C,W as A}from"./index-37Su0qRO.js";import{_ as v}from"./uni-icons.u6lZObLY.js";import{r as I}from"./uni-app.es.D58nOoD0.js";const $=a({data:()=>({auth:{realname:"",idcard:"",front:"",back:"",status:-1,remark:""},front:"",back:"",status:["待审核","审核通过","审核拒绝"],statusColor:["#ffb043","#18bc37","#ef6a60"]}),onLoad(){this.loadAuthData()},methods:{submit(){this.auth.realname&&this.auth.idcard&&this.auth.front&&this.auth.back?(s({mask:!0}),this.$api.authApi.submit(this.auth).then((a=>{0==a.code?(this.loadAuthData(),setTimeout((()=>{t({title:a.msg,icon:"none"})}),1e3)):(t({title:a.msg,icon:"none"}),e())}))):t({title:"请完善信息",icon:"none"})},loadAuthData(){s({mask:!0}),this.$api.authApi.getAuth().then((a=>{if(0==a.code){let t=a.data;t.status>=0?(this.auth=t,this.front=this.auth.preview_front,this.back=this.auth.preview_back):this.auth.status=-1}e()}))},chooseImage(a){if(1===this.auth.status||0===this.auth.status)return;let s=this;l({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{u({url:this.$api.msgApi.uploadUrl,filePath:e.tempFiles[0].path,name:"file",header:{Authorization:i("authToken")},success:l=>{let u=JSON.parse(l.data);0==u.code?(s.$set(this.auth,a,u.data.src),s.$set(this,a,e.tempFiles[0].path)):t({title:u.msg,icon:"none"})}})}})},deleteImage(a){this.$set(this.auth,a,""),this.$set(this,a,"")}}},[["render",function(a,t,s,e,l,u){const i=y,$=o("cu-custom"),x=m,V=w,D=C,F=I(c("uni-icons"),v),T=A;return p(),r(f,null,[h($,{bgColor:"bg-gradual-green",isBack:!0},{backText:d((()=>[])),content:d((()=>[k("实名认证")])),right:d((()=>[h(i,{onClick:u.loadAuthData,slot:"right",class:"cuIcon-refresh"},null,8,["onClick"])])),_:1}),h(x,{class:"container",style:n({height:`calc(100% - ${a.CustomBar}px)`})},{default:d((()=>[h(x,{class:"status-wrapper",style:n({color:l.auth.status>=0?l.statusColor[l.auth.status]:"#888888"})},{default:d((()=>[k(_(l.auth.status>=0?l.status[l.auth.status]:"未提交"),1)])),_:1},8,["style"]),h(x,{class:"info-wrapper"},{default:d((()=>[h(x,{class:"row-item"},{default:d((()=>[h(i,null,{default:d((()=>[k("真实姓名")])),_:1}),h(V,{modelValue:l.auth.realname,"onUpdate:modelValue":t[0]||(t[0]=a=>l.auth.realname=a),disabled:0===l.auth.status||1===l.auth.status,placeholder:"请输入真实姓名"},null,8,["modelValue","disabled"])])),_:1}),h(x,{class:"row-item"},{default:d((()=>[h(i,null,{default:d((()=>[k("身份证号")])),_:1}),h(V,{modelValue:l.auth.idcard,"onUpdate:modelValue":t[1]||(t[1]=a=>l.auth.idcard=a),disabled:0===l.auth.status||1===l.auth.status,placeholder:"请输入身份证号"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),h(x,{class:"card-wrapper"},{default:d((()=>[h(x,{class:"section-title"},{default:d((()=>[k("请上传身份证正面")])),_:1}),l.front?(p(),b(x,{key:1,class:"preview-area"},{default:d((()=>[h(D,{class:"preview-image",src:l.front,mode:"aspectFit"},null,8,["src"]),0!==l.auth.status&&1!==l.auth.status?(p(),b(x,{key:0,class:"delete-btn"},{default:d((()=>[h(F,{type:"close",size:"16",color:"#fff"})])),_:1})):g("",!0)])),_:1})):(p(),b(x,{key:0,class:"upload-area",onClick:t[2]||(t[2]=a=>u.chooseImage("front"))},{default:d((()=>[h(D,{src:"/assets/auth_front-BLcGvfmM.png"})])),_:1})),h(x,{class:"section-title",style:{"margin-top":"40rpx"}},{default:d((()=>[k("请上传身份证反面")])),_:1}),l.back?(p(),b(x,{key:3,class:"preview-area"},{default:d((()=>[h(D,{class:"preview-image",src:l.back,mode:"aspectFit"},null,8,["src"]),0!==l.auth.status&&1!==l.auth.status?(p(),b(x,{key:0,class:"delete-btn"},{default:d((()=>[h(F,{type:"close",size:"16",color:"#fff",onClick:t[5]||(t[5]=a=>u.deleteImage("back"))})])),_:1})):g("",!0)])),_:1})):(p(),b(x,{key:2,class:"upload-area",onClick:t[4]||(t[4]=a=>u.chooseImage("back"))},{default:d((()=>[h(D,{src:"/assets/auth_back-Dey9y6E1.png",onClick:t[3]||(t[3]=a=>u.deleteImage("front"))})])),_:1}))])),_:1}),2===l.auth.status?(p(),b(x,{key:0,class:"refuse-area"},{default:d((()=>[h(i,null,{default:d((()=>[k("拒绝原因")])),_:1}),h(i,null,{default:d((()=>[k(_(l.auth.remark?l.auth.remark:"暂无"),1)])),_:1})])),_:1})):g("",!0),h(x,{class:"opr-wrapper"},{default:d((()=>[1!==this.auth.status&&0!==this.auth.status?(p(),b(T,{key:0,type:"primary",onClick:u.submit},{default:d((()=>[k("提交审核")])),_:1},8,["onClick"])):g("",!0)])),_:1})])),_:1},8,["style"])],64)}],["__scopeId","data-v-991fc3d2"]]);export{$ as default};
