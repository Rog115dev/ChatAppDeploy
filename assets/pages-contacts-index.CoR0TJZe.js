import{_ as a,u as e,s as t,q as s,p as l,n as i,C as n,c,w as r,g as o,o as d,f as u,a as m,l as p,e as h,t as f,m as g,b as y,d as C,F as b,U as _,K as k,L as x,j as v,ab as w,X as T,ac as S,i as L}from"./index-CDOpH1f_.js";import{b as I}from"./breadcrum.Cqxo9PB4.js";import{s as B}from"./status.BmvdSoJv.js";const D=e(t),j=s(t),{contacts:N,sysUnread:V}=l(D);const M=a({components:{breadcurm:I,statusPoint:B},name:"contacts",props:{TabCur:{type:Number,default:0}},data:()=>({tabbarH:50,hidden:!0,listCurID:"",list:[],systemContact:[],listCur:"",total:0,scrollLeft:0,msgs:N,unread:V,globalConfig:j.globalConfig,appSetting:j.appSetting,tree:[{id:1,name:"技术部"},{id:2,name:"产品部"},{id:3,name:"信息部"}],depList:[{id:1,name:"技术部"},{id:2,name:"财务部"}],userList:[{id:1,realname:"张三",avatar:"https://api.multiavatar.com/raingad1.png?apikey=zdvXV3W4MjwhP9"},{id:2,realname:"李四",avatar:"https://api.multiavatar.com/raingad2.png?apikey=zdvXV3W4MjwhP9"}],tabList:["普通通讯录","企业通讯录"],contacts:[],keywords:""}),watch:{msgs(a){this.initContacts(a)}},created(){this.listCur=this.contacts[0]},mounted(){this.initContacts(this.msgs)},methods:{initContacts(a){const e=JSON.parse(JSON.stringify(a)),t=e.filter((a=>0==a.is_group));this.systemContact=e.filter((a=>2==a.is_group)),this.total=t.length;const s=t.sort(((a,e)=>"#"===a.index?1:"#"===e.index?-1:a.index.localeCompare(e.index,"zh"))).reduce(((a,e)=>{const t=e.index,s=a.findIndex((a=>a.name===t));return-1===s?a.push({name:t,children:[e]}):a[s].children.push(e),a}),[]);this.contacts=s},openDep(a){},openChat(a){i({url:"/pages/message/chat?id="+a,animationType:"slide-in-right"})},openDetails(a){i({url:"/pages/contacts/detail?id="+a.id})},openGroup(){i({url:"/pages/contacts/group"})},openLabel(){i({url:"/pages/message/label"})},openFriend(){i({url:"/pages/contacts/friend"})},tabSelect(a){this.TabCur=a.currentTarget.dataset.id,this.scrollLeft=60*(a.currentTarget.dataset.id-1)},getCur(a){this.hidden=!1,this.listCur=this.contacts[a.target.id].name},setCur(a){this.hidden=!0,this.listCur=this.listCur},tMove(a){let e=a.touches[0].clientY,t=this.boxTop,s=this;if(e>t){let a=parseInt((e-t)/20);this.listCur=s.contacts[a].name}},tStart(){this.hidden=!1},tEnd(){this.hidden=!0,this.listCurID=this.listCur},indexSelect(a){let e=this,t=this.barHeight,s=this.contacts,l=Math.ceil(s.length*a.detail.y/t);for(let i=0;i<s.length;i++)if(l<i+1)return e.listCur=s[i].name,e.movableY=20*i,!1}}},[["render",function(a,e,t,s,l,i){const I=v,B=w,D=o,j=n("Empty"),N=T,V=n("breadcurm"),M=S,O=L;return d(),c(D,null,{default:r((()=>[0==t.TabCur?(d(),c(N,{key:0,"scroll-y":"",class:"indexes","scroll-into-view":"indexes-"+l.listCurID,style:u([{height:"calc(100vh - "+(a.CustomBar+a.inlineTools+a.StatusBar)+"px)"}]),"scroll-with-animation":!0,"enable-back-to-top":!0},{default:r((()=>[m(D,{style:{"padding-bottom":"30rpx"}},{default:r((()=>[m(D,{class:"cu-bar search"},{default:r((()=>[m(D,{class:"search-form round"},{default:r((()=>[m(I,{class:"cuIcon-search"}),m(B,{type:"text",modelValue:l.keywords,"onUpdate:modelValue":e[0]||(e[0]=a=>l.keywords=a),placeholder:"搜索成员","confirm-type":"search"},null,8,["modelValue"])])),_:1})])),_:1}),m(D,{class:"cu-list menu"},{default:r((()=>[2==l.globalConfig.sysInfo.runMode?(d(),c(D,{key:0,class:"cu-item arrow",onClick:i.openFriend},{default:r((()=>[m(D,{class:p(["cu-avatar mr-15 invite-bg",l.appSetting.circleAvatar?"round":"radius"])},null,8,["class"]),m(D,{class:"content"},{default:r((()=>[m(I,{class:"c-f2cd77"},{default:r((()=>[h("新邀请")])),_:1})])),_:1}),m(D,{class:"action"},{default:r((()=>[l.unread>0?(d(),c(D,{key:0,class:"cu-tag round bg-red sm"},{default:r((()=>[h(f(l.unread),1)])),_:1})):g("",!0)])),_:1}),m(D,{class:"deliver"})])),_:1},8,["onClick"])):g("",!0),m(D,{class:"cu-item arrow",onClick:i.openGroup},{default:r((()=>[m(D,{class:p(["cu-avatar mr-15 group-bg",l.appSetting.circleAvatar?"round":"radius"])},null,8,["class"]),m(D,{class:"content"},{default:r((()=>[m(I,{class:"c-f2cd77"},{default:r((()=>[h("群聊")])),_:1})])),_:1}),m(D,{class:"deliver"})])),_:1},8,["onClick"]),m(D,{class:"cu-item arrow",onClick:i.openLabel},{default:r((()=>[m(D,{class:p(["cu-avatar mr-15 label-bg",l.appSetting.circleAvatar?"round":"radius"])},null,8,["class"]),m(D,{class:"content"},{default:r((()=>[m(I,{class:"c-f2cd77"},{default:r((()=>[h("标签")])),_:1})])),_:1}),m(D,{class:"deliver"})])),_:1},8,["onClick"]),(d(!0),y(b,null,C(l.systemContact,((a,e)=>(d(),c(D,{class:"cu-item arrow",onClick:e=>i.openChat(a.id),key:e},{default:r((()=>[m(D,{class:p(["cu-avatar mr-15",l.appSetting.circleAvatar?"round":"radius"]),style:u({background:"url("+a.avatar+")",backgroundSize:"contain"})},null,8,["style","class"]),m(D,{class:"content"},{default:r((()=>[m(I,{class:"c-f2cd77"},{default:r((()=>[h(f(a.displayName),1)])),_:2},1024)])),_:2},1024),m(D,{class:"deliver"})])),_:2},1032,["onClick"])))),128))])),_:1}),(d(!0),y(b,null,C(l.contacts,((a,e)=>(d(),c(D,{key:e,class:p("indexItem-"+a.name),id:"indexes-"+a.name,"data-index":a.name},{default:r((()=>[m(D,{class:"padding"},{default:r((()=>[h(f(a.name),1)])),_:2},1024),m(D,{class:"cu-list menu no-padding"},{default:r((()=>[(d(!0),y(b,null,C(a.children,((a,e)=>(d(),c(D,{class:"cu-item",key:e,onClick:e=>i.openDetails(a)},{default:r((()=>[!l.keywords||a.displayName.toLowerCase().indexOf(l.keywords.toLowerCase())>=0?(d(),c(D,{key:0,class:p(["cu-avatar mr-15",l.appSetting.circleAvatar?"round":"radius"]),style:u([{backgroundImage:"url("+a.avatar+")"}])},{default:r((()=>[a.is_online&&0==a.is_group&&l.globalConfig.chatInfo&&1==l.globalConfig.chatInfo.online?(d(),c(D,{key:0,class:"online-status-small"})):g("",!0)])),_:2},1032,["class","style"])):g("",!0),!l.keywords||a.displayName.toLowerCase().indexOf(l.keywords.toLowerCase())>=0?(d(),c(D,{key:1,class:"content"},{default:r((()=>[m(D,{class:"c-f2cd77 disNameS"},{default:r((()=>[h(f(a.displayName),1)])),_:2},1024)])),_:2},1024)):g("",!0),m(D,{class:"deliver"})])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1032,["class","id","data-index"])))),128)),m(D,{class:"text-center m-20 text-grey"},{default:r((()=>[h(f(l.total)+" 个朋友",1)])),_:1}),l.contacts.length?g("",!0):(d(),c(j,{key:0,noDatatext:"暂无联系人",textcolor:"#999"}))])),_:1})])),_:1},8,["scroll-into-view","style"])):g("",!0),0==t.TabCur?(d(),c(D,{key:1,class:"indexBar",style:u([{height:"calc(100vh - "+a.CustomBar+"px - 50px)"}])},{default:r((()=>[m(D,{class:"indexBar-box",onTouchstart:i.tStart,onTouchend:i.tEnd,onTouchmove:_(i.tMove,["stop"])},{default:r((()=>[(d(!0),y(b,null,C(l.contacts,((a,e)=>(d(),c(D,{class:"indexBar-item",key:e,id:e,onTouchstart:i.getCur,onTouchend:i.setCur},{default:r((()=>[h(f(a.name),1)])),_:2},1032,["id","onTouchstart","onTouchend"])))),128))])),_:1},8,["onTouchstart","onTouchend","onTouchmove"])])),_:1},8,["style"])):g("",!0),1==t.TabCur?(d(),c(D,{key:2,class:"cu-bar bg-white search fixed",style:u([{top:a.CustomBar+"px"}])},{default:r((()=>[m(D,{class:"search-form round"},{default:r((()=>[m(I,{class:"cuIcon-search"}),m(B,{type:"text",modelValue:l.keywords,"onUpdate:modelValue":e[1]||(e[1]=a=>l.keywords=a),placeholder:"输入搜索的关键词","confirm-type":"search"},null,8,["modelValue"])])),_:1})])),_:1},8,["style"])):g("",!0),1==t.TabCur?(d(),c(N,{key:3,"scroll-y":"",class:"indexes",style:u([{top:"50px",height:"calc(100vh - "+(a.CustomBar+a.inlineTools+a.StatusBar)+"px)"}]),"scroll-with-animation":!0,"enable-back-to-top":!0},{default:r((()=>[m(D,{class:""},{default:r((()=>[m(V,{tree:l.tree,onOpenBread:i.openDep},null,8,["tree","onOpenBread"])])),_:1}),m(D,{class:"im-department-list"},{default:r((()=>[(d(!0),y(b,null,C(l.depList,((a,e)=>(d(),c(M,{class:"im-flex im-justify-content-start im-align-items-center mt-10",onClick:e=>i.openDep(a),key:e},{default:r((()=>[m(D,{class:"im-folder-bar mr-10"},{default:r((()=>[m(I,{class:"cuIcon-file color-blue"})])),_:1}),m(D,{class:"im-list-body im-border-b"},{default:r((()=>[m(D,{class:"im-list-title word"},{default:r((()=>[h(f(a.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),(d(!0),y(b,null,C(l.userList,((a,e)=>(d(),c(M,{class:"im-flex im-justify-content-start im-align-items-center mt-10",key:a.id,url:"/pages/contacts/detail?user_id="+a.id},{default:r((()=>[m(D,{class:"im-folder-bar im-image mr-10"},{default:r((()=>[m(O,{src:a.avatar,mode:"widthFix"},null,8,["src"])])),_:2},1024),m(D,{class:"im-list-body im-border-b"},{default:r((()=>[m(D,{class:"im-list-title word"},{default:r((()=>[h(f(a.realname),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128)),0==l.depList.length&&0==l.userList.length?(d(),c(j,{key:0})):g("",!0)])),_:1})])),_:1},8,["style"])):g("",!0),k(m(D,{class:"indexToast"},{default:r((()=>[h(f(l.listCur),1)])),_:1},512),[[x,!l.hidden]])])),_:1})}],["__scopeId","data-v-0109ced0"]]);export{M as default};
