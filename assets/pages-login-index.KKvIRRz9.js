import{_ as o,q as e,s as t,x as l,G as a,n,y as s,as as i,Z as c,c as r,w as d,g,o as m,a as u,e as f,t as h,m as p,i as b,ab as _,W as F,at as k,a8 as C}from"./index-nIaQZq1w.js";import{p as x}from"./package.PDQEWYNF.js";import{_ as w,a as y}from"./lock.DHtl8Wgp.js";import{_ as L}from"./shield-line.D0ecq-vU.js";const V=e(t);const j=o({data:()=>({loginForm:{account:"",password:"",code:"",client_id:"",rememberMe:!1},forget:!1,packData:x,globalConfig:V.globalConfig}),watch:{forget(o){o&&(this.loginForm.password="123456")}},onLoad(o){const e=o.token;e&&this.doLogin({token:e})},mounted(){if(this.globalConfig&&this.globalConfig.demon_mode){const o=Math.floor(19*Math.random()+2);this.loginForm.account=138e8+o,this.loginForm.password="123456"}let o=l("LoginAccount");o&&(this.loginForm=o)},methods:{switchChange(o){this.loginForm.rememberMe=o.detail.value},checkboxChange(o){this.loginForm.rememberMe=!this.loginForm.rememberMe},sendCode(){if(!this.loginForm.account)return a({title:"请输入账号！",icon:"none"}),!1;let o={account:this.loginForm.account,type:1};this.$api.LoginApi.sendCode(o).then((o=>{a({title:o.msg,icon:"none"})}))},register(){n({url:"/pages/login/register"})},login(){if(this.loginForm.rememberMe?s("LoginAccount",this.loginForm):i("LoginAccount"),""==this.loginForm.account)return a({title:"请输入账号！",icon:"none"}),!1;if(""==this.loginForm.password)return a({title:"请输入密码！",icon:"none"}),!1;let o=l("client_id");o&&(this.loginForm.client_id=o),this.doLogin(this.loginForm)},doLogin(o){this.$api.LoginApi.login(o).then((o=>{if(0==o.code){s("authToken",o.data.authToken),s("trtc_appid",o.data.trtc_appid),s("trtc_sign",o.data.trtc_sign);let e=o.data.userInfo;this.socketIo.send({type:"bindUid",user_id:e.user_id,token:o.data.authToken}),V.login(e),c({url:"/pages/index/index"})}}))}}},[["render",function(o,e,t,l,a,n){const s=g,i=b,c=_,x=F,V=k,j=C;return m(),r(s,{class:"ctn"},{default:d((()=>[u(s,{style:{height:"194rpx"}}),u(s,{class:"im-flex im-rows im-justify-content-center logsc"},{default:d((()=>[u(s,{class:"im-flex im-rows im-justify-content-center"},{default:d((()=>[u(i,{class:"login-logo",src:a.globalConfig.sysInfo.logo??a.packData.logo,mode:"fixWidth"},null,8,["src"])])),_:1})])),_:1}),u(s,{class:"im-flex im-rows im-justify-content-center name"},{default:d((()=>[f(h(a.packData.name),1)])),_:1}),u(V,{class:"ifc"},{default:d((()=>[u(s,{class:"cu-form-group cu-form-border-bottom"},{default:d((()=>[u(s,{class:"title"},{default:d((()=>[u(i,{src:w,mode:"widthFix"})])),_:1}),u(c,{placeholder:"请输入账号",maxlength:"32",name:"input",modelValue:a.loginForm.account,"onUpdate:modelValue":e[0]||(e[0]=o=>a.loginForm.account=o)},null,8,["modelValue"])])),_:1}),a.forget?(m(),r(s,{key:1,class:"cu-form-group cu-form-border-bottom"},{default:d((()=>[u(s,{class:"title"},{default:d((()=>[u(i,{src:L,mode:"widthFix"})])),_:1}),u(c,{placeholder:"请输入验证码",maxlength:"6",name:"input",modelValue:a.loginForm.code,"onUpdate:modelValue":e[2]||(e[2]=o=>a.loginForm.code=o)},null,8,["modelValue"]),u(x,{class:"cu-btn bg-blue shadow btn-code",onClick:n.sendCode},{default:d((()=>[f("发送验证码")])),_:1},8,["onClick"])])),_:1})):(m(),r(s,{key:0,class:"cu-form-group cu-form-border-bottom"},{default:d((()=>[u(s,{class:"title"},{default:d((()=>[u(i,{src:y,mode:"widthFix"})])),_:1}),u(c,{placeholder:"请输入密码",maxlength:"32",type:"password",name:"input",modelValue:a.loginForm.password,"onUpdate:modelValue":e[1]||(e[1]=o=>a.loginForm.password=o)},null,8,["modelValue"])])),_:1}))])),_:1}),u(s,{class:"forget"},{default:d((()=>[u(s,null,{default:d((()=>[u(j,{value:"cb",checked:a.loginForm.rememberMe,activeBackgroundColor:"#0081FF",onChange:n.checkboxChange,style:{transform:"scale(0.7)"}},null,8,["checked","onChange"]),f("记住我 ")])),_:1})])),_:1}),u(s,{class:"flex flex-direction im-login-btn"},{default:d((()=>[u(x,{class:"cu-btn lg bg-login",onClick:e[3]||(e[3]=o=>n.login())},{default:d((()=>[f("登录")])),_:1})])),_:1}),a.globalConfig&&a.globalConfig.sysInfo&&1==a.globalConfig.sysInfo.regtype?(m(),r(s,{key:0,class:"flex flex-direction im-reg-btn"},{default:d((()=>[u(x,{class:"cu-btn lg bg-reg",onClick:e[4]||(e[4]=o=>n.register())},{default:d((()=>[f("注册")])),_:1})])),_:1})):p("",!0),a.globalConfig&&a.globalConfig.demon_mode?(m(),r(s,{key:1,class:"m-20 c-666"},{default:d((()=>[u(s,{class:"f-16 remark-title mb-10"},{default:d((()=>[f("站点仅用于演示，演示账号")])),_:1}),u(s,{class:"c-999"},{default:d((()=>[f("账号：13800000002~13800000020")])),_:1}),u(s,{class:"c-999"},{default:d((()=>[f("密码：123456")])),_:1})])),_:1})):p("",!0)])),_:1})}],["__scopeId","data-v-69675dab"]]);export{j as default};
